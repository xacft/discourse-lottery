# 🎲 Discourse 抽奖插件使用指南

## 📝 如何创建抽奖

### 方法一：简单创建（默认设置）

在帖子内容中输入：
```
[在此创建抽奖]
```

**效果：**
- 标题：帖子 [ID] 的示例抽奖
- 奖品：一份惊喜奖品!
- 积分消耗：5 积分
- 最大参与人数：50 人

### 方法二：自定义创建（推荐）

在帖子内容中使用以下格式：
```
[lottery title="抽奖标题" prize="奖品名称" cost="积分消耗" max="最大人数"]
```

## 🎯 自定义参数详解

### 完整示例
```
[lottery title="iPhone 15 Pro 抽奖" prize="iPhone 15 Pro 256GB" cost="50" max="100"]
```

### 参数说明

| 参数 | 别名 | 说明 | 示例 | 必填 |
|------|------|------|------|------|
| `title` | `name` | 抽奖标题 | `title="新年抽奖"` | ❌ |
| `prize` | `reward` | 奖品名称 | `prize="MacBook Pro"` | ❌ |
| `cost` | `points` | 参与所需积分 | `cost="10"` | ❌ |
| `max` | `limit`, `max_entries` | 最大参与人数 | `max="50"` | ❌ |

### 参数详细说明

#### 1. **title** (抽奖标题)
- **默认值**: "社区抽奖"
- **示例**: 
  ```
  title="春节特别抽奖"
  title="会员专享抽奖"
  ```

#### 2. **prize** (奖品名称)
- **默认值**: "神秘奖品"
- **示例**:
  ```
  prize="iPhone 15 Pro"
  prize="100元京东卡"
  prize="限量版周边"
  ```

#### 3. **cost** (积分消耗)
- **默认值**: 0 (免费)
- **类型**: 整数
- **示例**:
  ```
  cost="0"    # 免费参与
  cost="10"   # 消耗10积分
  cost="100"  # 消耗100积分
  ```

#### 4. **max** (最大参与人数)
- **默认值**: 无限制
- **类型**: 正整数
- **示例**:
  ```
  max="50"    # 最多50人参与
  max="100"   # 最多100人参与
  max="10"    # 限量10人
  ```

## 📋 使用示例

### 示例1：免费抽奖
```
大家好！我们举办一个免费抽奖活动！

[lottery title="社区感谢抽奖" prize="精美周边礼品" cost="0" max="30"]

欢迎大家参与！
```

### 示例2：积分抽奖
```
🎉 新品发布庆祝抽奖！

[lottery title="iPhone 15 抽奖" prize="iPhone 15 Pro 256GB" cost="100" max="50"]

使用积分参与，中奖率更高！
```

### 示例3：限量抽奖
```
⚡ 限时限量抽奖！

[lottery title="闪电抽奖" prize="Switch游戏机" cost="50" max="10"]

仅限前10名，先到先得！
```

### 示例4：多个参数组合
```
🏆 年度大奖抽奖

[lottery title="年度终极大奖" prize="MacBook Pro + iPhone 15" cost="200" max="20"]

最豪华奖品，最激动人心的抽奖！
```

## ⚠️ 注意事项

### 1. **帖子要求**
- 只能在**主题的第一个帖子**中创建抽奖
- 每个帖子只能创建一个抽奖

### 2. **参数格式**
- 参数值必须用引号包围：`"值"`
- 参数之间用空格分隔
- 参数名不区分大小写

### 3. **积分系统**
- 需要安装积分插件（如 Discourse Gamification）
- 用户积分不足时无法参与付费抽奖

### 4. **权限要求**
- 需要在管理面板启用"抽奖插件"设置
- 用户需要有发帖权限

## 🎮 用户参与流程

1. **查看抽奖**: 用户在帖子中看到抽奖框
2. **点击参与**: 点击"参与抽奖"按钮
3. **确认消耗**: 如果需要积分，会弹出确认对话框
4. **参与成功**: 显示成功消息，更新参与人数
5. **防重复**: 已参与的用户无法重复参与

## 🔧 管理员设置

1. **启用插件**: 管理面板 → 设置 → 插件 → 启用"抽奖插件"
2. **查看日志**: 检查 `/logs` 查看插件运行状态
3. **数据库**: 抽奖数据存储在 `lottery_plugin_lotteries` 表中

---

🎉 **开始创建您的第一个抽奖吧！**
